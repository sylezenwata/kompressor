!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Kompressor",[],e):"object"==typeof exports?exports.Kompressor=e():t.Kompressor=e()}(self,(function(){return function(){"use strict";var t={d:function(e,n){for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},o:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}},e={};function n(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}t.d(e,{default:function(){return o}});var o=function(){function t(e){var n=e.width,o=void 0===n?null:n,r=e.height,i=void 0===r?null:r,a=e.xOrigin,u=void 0===a?0:a,s=e.yOrigin,l=void 0===s?0:s,c=e.smoothingQuality,f=void 0===c?"low":c,d=e.quality,v=void 0===d?.2:d;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.width=o,this.height=i,this.xOrigin=u,this.yOrigin=l,this.smoothingQuality=f,this.quality=v,this.formatsToOverride=["png","jpg"]}var e,o;return e=t,(o=[{key:"toBlob",value:function(t){var e=this;return new Promise((function(n){t.toBlob(n,"image/".concat(e.format),e.quality)}))}},{key:"compress",value:function(t){var e=this;return new Promise((function(n,o){var r=document.createElement("canvas"),i=r.getContext("2d");i||o(new Error("Canvas context is not availbale"));var a=e.width||t.naturalWidth,u=e.height||t.naturalHeight;r.width=a,r.height=u,i.imageSmoothingsmoothingQuality=e.smoothingQuality,i.save(),i.drawImage(t,e.xOrigin,e.yOrigin,a,u),i.restore(),e.toBlob(r).then((function(t){var e=URL.createObjectURL(t);n({url:e,blob:t})})).catch((function(t){console.log(t),o(new Error("Blob conversion failed"))}))}))}},{key:"setFormat",value:function(t){var e;t=null===(e=t)||void 0===e?void 0:e.toString().toLowerCase(),this.format=this.formatsToOverride.some((function(e){return e===t}))||!t?"jpeg":t}},{key:"process",value:function(t){var e=this;return new Promise((function(n,o){var r=new FileReader;r.addEventListener("load",(function(t){var r;e.setFormat(null===(r=t.target.result.split(";")[0])||void 0===r?void 0:r.split("/")[1]);var i=new Image;i.src=t.target.result,i.addEventListener("load",(function(){e.compress(i).then((function(t){return n(t)})).catch((function(t){return o(t)}))}))})),r.readAsDataURL(t)}))}},{key:"readableSize",value:function(t){return t/1024>1024?~~(10*t/1024/1024)/10+"MB":~~(t/1024)+"KB"}}])&&n(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();return e.default}()}));